<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>TB Drug Dose Calculator</title>

<style>
    body {
        font-family: Arial, sans-serif;
        background: #f4f6f9;
        padding: 30px;
    }
    .container {
        max-width: 650px;
        margin: auto;
        background: white;
        padding: 25px;
        border-radius: 10px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    h2 {
        text-align: center;
        margin-bottom: 20px;
    }
    label {
        font-weight: bold;
    }
    input {
        width: 100%;
        padding: 8px;
        margin: 10px 0 20px 0;
        font-size: 16px;
    }
    button {
        width: 100%;
        padding: 12px;
        background: #1976d2;
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 16px;
        cursor: pointer;
    }
    button:hover {
        background: #125aa0;
    }
    .result {
        margin-top: 25px;
        padding: 15px;
        border-radius: 8px;
        background: #eef3f8;
    }
    .drug {
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 1px dashed #bbb;
    }
    .alert {
        color: red;
        font-weight: bold;
    }
    small {
        display: block;
        margin-top: 10px;
        color: #555;
    }
</style>
</head>

<body>

<div class="container">
    <h2>คำนวณขนาดยาวัณโรค</h2>

    <label>น้ำหนักตัว (kg)</label>
    <input type="number" id="weight" placeholder="เช่น 60" min="1">

    <button onclick="calculateDose()">คำนวณขนาดยา</button>

    <div id="result" class="result" style="display:none;"></div>
</div>

<script>
function calculateDrug(weight, minMgKg, maxMgKg, maxDose) {
    let minDose = weight * minMgKg;
    let maxDoseCalc = weight * maxMgKg;

    let finalMin = Math.min(minDose, maxDose);
    let finalMax = Math.min(maxDoseCalc, maxDose);

    return {
        min: Math.round(finalMin),
        max: Math.round(finalMax),
        exceeded: maxDoseCalc > maxDose
    };
}

function calculateTablets(dose, strengths) {
    return strengths.map(s => {
        return {
            strength: s,
            tablets: Math.ceil(dose / s)
        };
    });
}

function calculateDose() {
    const weight = document.getElementById("weight").value;
    if (!weight || weight <= 0) {
        alert("กรุณาระบุน้ำหนักให้ถูกต้อง");
        return;
    }

    const H = calculateDrug(weight, 4, 6, 300);
    const R = calculateDrug(weight, 8, 12, 600);
    const Z = calculateDrug(weight, 20, 30, 2000);
    const E = calculateDrug(weight, 15, 20, 2000);

    const R_tabs = calculateTablets(R.max, [300, 450]);
    const E_tabs = calculateTablets(E.max, [400, 500]);

    const resultDiv = document.getElementById("result");
    resultDiv.style.display = "block";

    resultDiv.innerHTML = `
        <div class="drug">
            <b>Isoniazid (H)</b><br>
            ขนาดยา: ${H.min} – ${H.max} mg/day
            ${H.exceeded ? '<br><span class="alert">⚠ max dose (300 mg)</span>' : ''}
        </div>

        <div class="drug">
            <b>Rifampicin (R)</b><br>
            ขนาดยา: ${R.min} – ${R.max} mg/day<br>
            ${R_tabs.map(t => `• ${t.strength} mg/tab → ${t.tablets} เม็ด<br>`).join("")}
            ${R.exceeded ? '<span class="alert">⚠ max dose (600 mg)</span>' : ''}
        </div>

        <div class="drug">
            <b>Pyrazinamide (Z)</b><br>
            ขนาดยา: ${Z.min} – ${Z.max} mg/day
            ${Z.exceeded ? '<br><span class="alert">⚠ max dose (2000 mg)</span>' : ''}
        </div>

        <div class="drug">
            <b>Ethambutol (E)</b><br>
            ขนาดยา: ${E.min} – ${E.max} mg/day<br>
            ${E_tabs.map(t => `• ${t.strength} mg/tab → ${t.tablets} เม็ด<br>`).join("")}
            ${E.exceeded ? '<span class="alert">⚠ max dose (2000 mg)</span>' : ''}
        </div>

        <small>
        ⚠️ เครื่องมือนี้ใช้เพื่อช่วยคำนวณขนาดยาเท่านั้น  
        ไม่ทดแทนดุลยพินิจแพทย์
        </small>
    `;
}
</script>

</body>
</html>



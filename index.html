<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>TB Drug Dose Calculator</title>
<style>
body{font-family:Arial;background:#f4f6f9;padding:30px}
.container{max-width:750px;margin:auto;background:#fff;padding:25px;border-radius:10px}
h2,h3{text-align:center}
.drug{margin-bottom:15px}
.alert{color:red;font-weight:bold}
small{color:#555}
button{width:100%;padding:12px;background:#1976d2;color:#fff;border:none;border-radius:6px}
input{width:100%;padding:8px;margin:10px 0}
</style>
</head>

<body>
<div class="container">
<h2>คำนวณขนาดยาวัณโรค</h2>

<input type="number" id="weight" placeholder="น้ำหนัก (kg)">
<button onclick="calc()">คำนวณ</button>

<div id="result"></div>
</div>

<script>
function rangeDose(w,min,max,maxDose){
  let lo=w*min, hi=w*max;
  return {
    min:Math.round(Math.min(lo,maxDose)),
    max:Math.round(Math.min(hi,maxDose)),
    hitMax:hi>maxDose
  };
}

function recommend(range,strength){
  let options=[];
  for(let t=0.5;t<=10;t+=0.5){
    let dose=t*strength;
    if(dose>=range.min && dose<=range.max){
      options.push(`${t} เม็ด (${dose} mg)`);
    }
  }
  return options.length ? options.join("<br>• ") : "<span class='alert'>⚠ ไม่สามารถจัดขนาดยาที่เหมาะสมได้</span>";
}

function calc(){
  let w=document.getElementById("weight").value;
  if(!w||w<=0){alert("กรอกน้ำหนัก");return;}

  const H=rangeDose(w,4,6,300);
  const R=rangeDose(w,8,12,600);
  const Z=rangeDose(w,20,30,2000);
  const E=rangeDose(w,15,20,1200);

  let html=`<h3>ยาแยกเม็ด</h3>`;

  html+=`
  <div class="drug"><b>Pyrazinamide (Z) 20–30 mg/kg/day</b><br>
  ${Z.min} – ${Z.max} mg/day<br>
  • ${recommend(Z,500)}</div>`;

  html+=`
  <div class="drug"><b>Ethambutol (E) 15–20 mg/kg/day</b><br>
  ${E.min} – ${E.max} mg/day<br>
  • 500 mg/tab<br>• ${recommend(E,500)}<br>
  • 400 mg/tab<br>• ${recommend(E,400)}
  <br><span class="alert">⚠ max dose 1200 mg</span>
  </div>`;

  html+=`
  <small>
  ⚠ การคำนวณอาจผิดพลาดได้ กรุณาตรวจสอบข้อมูลก่อนนำไปใช้<br>
  เครื่องมือนี้ไม่ทดแทนดุลยพินิจแพทย์
  </small>`;

  document.getElementById("result").innerHTML=html;
}
</script>
</body>
</html>

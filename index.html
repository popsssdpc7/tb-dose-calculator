<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>TB Drug Dose Calculator</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #f4f6f9;
        padding: 30px;
    }
    .container {
        max-width: 600px;
        margin: auto;
        background: white;
        padding: 25px;
        border-radius: 10px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    h2 {
        text-align: center;
        margin-bottom: 20px;
    }
    input {
        width: 100%;
        padding: 8px;
        margin-bottom: 20px;
    }
    button {
        width: 100%;
        padding: 12px;
        background: #1976d2;
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 16px;
        cursor: pointer;
    }
    button:hover {
        background: #125aa0;
    }
    .result {
        margin-top: 25px;
        padding: 15px;
        border-radius: 8px;
        background: #eef3f8;
    }
    .drug {
        margin-bottom: 12px;
        padding-bottom: 8px;
        border-bottom: 1px dashed #ccc;
    }
    .alert {
        color: red;
        font-weight: bold;
    }
    small {
        display: block;
        margin-top: 10px;
    }
</style>
</head>
<body>

<div class="container">
    <h2>คำนวณขนาดยาวัณโรค</h2>

    <label>น้ำหนักตัว (kg)</label>
    <input type="number" id="weight" placeholder="เช่น 60" min="1">

    <button onclick="calculateDose()">คำนวณ</button>

    <div id="result" class="result" style="display:none;"></div>
</div>

<script>
function calculateDrug(weight, minMgKg, maxMgKg, maxDose, tabletStrength) {
    let minDose = weight * minMgKg;
    let maxDoseCalc = weight * maxMgKg;

    let finalMin = Math.min(minDose, maxDose);
    let finalMax = Math.min(maxDoseCalc, maxDose);

    let tabletsMin = Math.round(finalMin / tabletStrength);
    let tabletsMax = Math.round(finalMax / tabletStrength);

    let exceeded = maxDoseCalc > maxDose;

    return {
        min: finalMin.toFixed(0),
        max: finalMax.toFixed(0),
        tabMin: tabletsMin,
        tabMax: tabletsMax,
        exceeded: exceeded
    };
}

function calculateDose() {
    const weight = document.getElementById("weight").value;
    if (!weight || weight <= 0) {
        alert("กรุณาระบุน้ำหนักให้ถูกต้อง");
        return;
    }

    const H = calculateDrug(weight, 4, 6, 300, 100);
    const R = calculateDrug(weight, 8, 12, 600, 150);
    const Z = calculateDrug(weight, 20, 30, 2000, 500);
    const E = calculateDrug(weight, 15, 20, 1200, 400);

    const resultDiv = document.getElementById("result");
    resultDiv.style.display = "block";
    resultDiv.innerHTML = `
        <div class="drug">
            <b>Isoniazid (H)</b><br>
            ขนาดยา: ${H.min} – ${H.max} mg/day<br>
            จำนวนเม็ด: ${H.tabMin} – ${H.tabMax} เม็ด (100 mg)<br>
            ${H.exceeded ? '<span class="alert">⚠ เกิน max dose (300 mg)</span>' : ''}
        </div>

        <div class="drug">
            <b>Rifampicin (R)</b><br>
            ขนาดยา: ${R.min} – ${R.max} mg/day<br>
            จำนวนเม็ด: ${R.tabMin} – ${R.tabMax} เม็ด (150 mg)<br>
            ${R.exceeded ? '<span class="alert">⚠ เกิน max dose (600 mg)</span>' : ''}
        </div>

        <div class="drug">
            <b>Pyrazinamide (Z)</b><br>
            ขนาดยา: ${Z.min} – ${Z.max} mg/day<br>
            จำนวนเม็ด: ${Z.tabMin} – ${Z.tabMax} เม็ด (500 mg)<br>
            ${Z.exceeded ? '<span class="alert">⚠ เกิน max dose (2000 mg)</span>' : ''}
        </div>

        <div class="drug">
            <b>Ethambutol (E)</b><br>
            ขนาดยา: ${E.min} – ${E.max} mg/day<br>
            จำนวนเม็ด: ${E.tabMin} – ${E.tabMax} เม็ด (400 mg)<br>
            ${E.exceeded ? '<span class="alert">⚠ เกิน max dose (1200 mg)</span>' : ''}
        </div>

        <small>
        ⚠️ ใช้เป็นเครื่องมือช่วยคำนวณ ไม่ทดแทนดุลยพินิจแพทย์<br>
        คำนวณตามน้ำหนักและขนาดยา mg/kg/day
        </small>
    `;
}
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>TB Drug Dose Calculator</title>

<style>
body {
    font-family: Arial, sans-serif;
    background: #f4f6f9;
    padding: 30px;
}
.container {
    max-width: 760px;
    margin: auto;
    background: white;
    padding: 25px;
    border-radius: 10px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}
h2, h3 { text-align: center; }
label { font-weight: bold; }
input {
    width: 100%;
    padding: 8px;
    margin: 10px 0 20px;
    font-size: 16px;
}
button {
    width: 100%;
    padding: 12px;
    background: #1976d2;
    color: white;
    border: none;
    border-radius: 6px;
    font-size: 16px;
    cursor: pointer;
}
button:hover { background: #125aa0; }
.result {
    margin-top: 25px;
    padding: 15px;
    border-radius: 8px;
    background: #eef3f8;
}
.section {
    margin-top: 20px;
}
.drug {
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 1px dashed #bbb;
}
.alert { color: red; font-weight: bold; }
small { color: #555; }
</style>
</head>

<body>

<div class="container">
<h2>‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤‡∏ß‡∏±‡∏ì‡πÇ‡∏£‡∏Ñ</h2>

<label>‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ï‡∏±‡∏ß (kg)</label>
<input type="number" id="weight" placeholder="‡πÄ‡∏ä‡πà‡∏ô 60" min="1">

<button onclick="calculateDose()">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤</button>

<div id="result" class="result" style="display:none;"></div>
</div>

<script>
// ===== Dose range =====
function doseRange(weight, minKg, maxKg, maxDose) {
    return {
        min: Math.round(weight * minKg),
        max: Math.round(Math.min(weight * maxKg, maxDose)),
        maxDose: maxDose
    };
}

// ===== Tablet options (single drug) =====
function tabletOptions(minDose, maxDose, strengths, absoluteMax) {
    let opts = [];
    strengths.forEach(s => {
        for (let t = 1; t <= 10; t++) {
            let dose = t * s;
            if (dose >= minDose && dose <= maxDose && dose <= absoluteMax) {
                opts.push(`‚Ä¢ ${t} ‡πÄ‡∏°‡πá‡∏î (${s} mg/tab = ${dose} mg)`);
            }
        }
    });
    return opts.join("<br>");
}

// ===== FDC calculation =====
function fdcOptions(weight, components) {
    let valid = [];
    for (let tabs = 1; tabs <= 10; tabs++) {
        let ok = true;
        for (let c of components) {
            let dose = tabs * c.strength;
            let min = weight * c.minKg;
            let max = Math.min(weight * c.maxKg, c.maxDose);
            if (dose < min || dose > max) {
                ok = false;
                break;
            }
        }
        if (ok) valid.push(`${tabs} ‡πÄ‡∏°‡πá‡∏î`);
    }
    return valid.length ? valid.join(", ") : `<span class="alert">‚ö† ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°</span>`;
}

function calculateDose() {
    const w = document.getElementById("weight").value;
    if (!w || w <= 0) {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á");
        return;
    }

    // ===== Single drugs =====
    const H = doseRange(w, 4, 6, 300);
    const R = doseRange(w, 8, 12, 600);
    const Z = doseRange(w, 20, 30, 2000);
    const E = doseRange(w, 15, 20, 1200);

    // ===== FDC =====
    const FDC2 = fdcOptions(w, [
        { strength: 75,  minKg: 4,  maxKg: 6,  maxDose: 300 },
        { strength: 150, minKg: 8,  maxKg: 12, maxDose: 600 }
    ]);

    const FDC4 = fdcOptions(w, [
        { strength: 75,  minKg: 4,  maxKg: 6,  maxDose: 300 },
        { strength: 150, minKg: 8,  maxKg: 12, maxDose: 600 },
        { strength: 400, minKg: 20, maxKg: 30, maxDose: 2000 },
        { strength: 275, minKg: 15, maxKg: 20, maxDose: 1200 }
    ]);

    const r = document.getElementById("result");
    r.style.display = "block";

    r.innerHTML = `
    <div class="section">
    <h3>üîπ ‡∏¢‡∏≤‡πÅ‡∏¢‡∏Å‡πÄ‡∏°‡πá‡∏î</h3>

    <div class="drug"><b>Isoniazid (H) 4-6 mkd</b><br>
    ${H.min} ‚Äì ${H.max} mg/day<br>
    ${tabletOptions(H.min, H.max, [100], 300)}</div>

    <div class="drug"><b>Rifampicin (R) 8-12 mkd</b><br>
    ${R.min} ‚Äì ${R.max} mg/day<br>
    ${tabletOptions(R.min, R.max, [300], 600)}</div>

    <div class="drug"><b>Pyrazinamide (Z) 20-30 mkd</b><br>
    ${Z.min} ‚Äì ${Z.max} mg/day<br>
    ${tabletOptions(Z.min, Z.max, [500], 2000)}</div>

    <div class="drug"><b>Ethambutol (E) 15-20 mkd</b><br>
    ${E.min} ‚Äì ${E.max} mg/day<br>
    ${tabletOptions(E.min, E.max, [500, 400], 1200)}
    <br><span class="alert">‚ö† max dose 1200 mg</span></div>
    </div>

    <div class="section">
    <h3>üîπ Fixed-Dose Combination (FDC)</h3>

    <div class="drug"><b>2FDC</b> (H75 + R150)<br>
    ‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ: ${FDC2}</div>

    <div class="drug"><b>4FDC</b> (H75 + R150 + Z400 + E275)<br>
    ‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ: ${FDC4}</div>
    </div>

    <small>
    ‚ö†Ô∏è ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ç‡∏ô‡∏≤‡∏î‡∏¢‡∏≤‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô  
    ‡πÑ‡∏°‡πà‡∏ó‡∏î‡πÅ‡∏ó‡∏ô‡∏î‡∏∏‡∏•‡∏¢‡∏û‡∏¥‡∏ô‡∏¥‡∏à‡πÅ‡∏û‡∏ó‡∏¢‡πå
    ‚ö†Ô∏è ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏≠‡∏≤‡∏à‡πÄ‡∏Å‡∏¥‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏≥‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡πÉ‡∏ä‡πâ
    </small>
    `;
}
</script>

</body>
</html>


